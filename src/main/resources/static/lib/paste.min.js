(function(){var t,e,n,r;t=window.jQuery,t.paste=function(t){var n;return"undefined"!=typeof console&&null!==console&&console.log("DEPRECATED: This method is deprecated. Please use $.fn.pastableNonInputable() instead."),n=e.mountNonInputable(t),n._container},t.fn.pastableNonInputable=function(){var t,n,r;for(n=0,r=this.length;r>n;n++)t=this[n],e.mountNonInputable(t);return this},t.fn.pastableTextarea=function(){var t,n,r;for(n=0,r=this.length;r>n;n++)t=this[n],e.mountTextarea(t);return this},t.fn.pastableContenteditable=function(){var t,n,r;for(n=0,r=this.length;r>n;n++)t=this[n],e.mountContenteditable(t);return this},r=function(t,e){var n,r,a,o,i,u,s,c,l,f,h;if(null==e&&(e=512),!(c=t.match(/^data\:([^\;]+)\;base64\,(.+)$/)))return null;for(f=c,c=f[0],u=f[1],n=f[2],o=atob(n),a=[],l=0;l<o.length;){for(h=o.slice(l,l+e),i=new Array(h.length),s=0;s<h.length;)i[s]=h.charCodeAt(s),s++;r=new Uint8Array(i),a.push(r),l+=e}return new Blob(a,{type:u})},n=function(){return t(document.createElement("div")).attr("contenteditable",!0).attr("aria-hidden",!0).attr("tabindex",-1).css({width:1,height:1,position:"fixed",left:-100,overflow:"hidden"})},e=function(){function e(e,n){this._container=e,this._target=n,this._container=t(this._container),this._target=t(this._target).addClass("pastable"),this._container.on("paste",function(t){return function(e){var n,r,a,o,i,u,s,c,l,f,h,g,d;if(t._paste_event_fired=!0,null!=(null!=(l=e.originalEvent)?l.clipboardData:void 0))if(n=e.originalEvent.clipboardData,n.items)for(f=n.items,o=0,u=f.length;u>o;o++)a=f[o],a.type.match(/^image\//)&&(c=new FileReader,c.onload=function(e){return t._handleImage(e.target.result)},c.readAsDataURL(a.getAsFile())),"text/plain"===a.type&&a.getAsString(function(e){return t._target.trigger("pasteText",{text:e})});else-1!==Array.prototype.indexOf.call(n.types,"text/plain")&&(d=n.getData("Text"),setTimeout(function(){return t._target.trigger("pasteText",{text:d})},1)),t._checkImagesInContainer(function(e){return t._handleImage(e)});if(n=window.clipboardData)if(null!=(h=d=n.getData("Text"))?h.length:void 0)setTimeout(function(){return t._target.trigger("pasteText",{text:d}),t._target.trigger("_pasteCheckContainerDone")},1);else{for(g=n.files,i=0,s=g.length;s>i;i++)r=g[i],t._handleImage(URL.createObjectURL(r));t._checkImagesInContainer(function(t){})}return null}}(this))}return e.prototype._target=null,e.prototype._container=null,e.mountNonInputable=function(r){var a;return a=new e(n().appendTo(r),r),t(r).on("click",function(t){return function(){return a._container.focus()}}(this)),a._container.on("focus",function(e){return function(){return t(r).addClass("pastable-focus")}}(this)),a._container.on("blur",function(e){return function(){return t(r).removeClass("pastable-focus")}}(this))},e.mountTextarea=function(r){var a,o;return navigator.userAgent.toLowerCase().match(/firefox|trident|edge/)?(o=new e(n().insertBefore(r),r),a=!1,t(r).on("keyup",function(t){var e;return 17!==(e=t.keyCode)&&224!==e||(a=!1),null}),t(r).on("keydown",function(e){var n;return 17!==(n=e.keyCode)&&224!==n||(a=!0),null!=e.ctrlKey&&null!=e.metaKey&&(a=e.ctrlKey||e.metaKey),a&&86===e.keyCode&&(o._textarea_focus_stolen=!0,o._container.focus(),o._paste_event_fired=!1,setTimeout(function(e){return function(){return o._paste_event_fired?void 0:(t(r).focus(),o._textarea_focus_stolen=!1)}}(this),1)),null}),t(r).on("paste",function(t){return function(){}}(this)),t(r).on("focus",function(e){return function(){return o._textarea_focus_stolen?void 0:t(r).addClass("pastable-focus")}}(this)),t(r).on("blur",function(e){return function(){return o._textarea_focus_stolen?void 0:t(r).removeClass("pastable-focus")}}(this)),t(o._target).on("_pasteCheckContainerDone",function(e){return function(){return t(r).focus(),o._textarea_focus_stolen=!1}}(this)),t(o._target).on("pasteText",function(e){return function(e,n){var a,o,i;return i=t(r).prop("selectionStart"),o=t(r).prop("selectionEnd"),a=t(r).val(),t(r).val(""+a.slice(0,i)+n.text+a.slice(o)),t(r)[0].setSelectionRange(i+n.text.length,i+n.text.length),t(r).trigger("change")}}(this))):this.mountContenteditable(r)},e.mountContenteditable=function(n){var r;return r=new e(n,n),t(n).on("focus",function(e){return function(){return t(n).addClass("pastable-focus")}}(this)),t(n).on("blur",function(e){return function(){return t(n).removeClass("pastable-focus")}}(this))},e.prototype._handleImage=function(t){var e;return t.match(/^webkit\-fake\-url\:\/\//)?this._target.trigger("pasteImageError",{message:"You are trying to paste an image in Safari, however we are unable to retieve its data."}):(e=new Image,e.crossOrigin="anonymous",e.onload=function(t){return function(){var n,a,o,i;a=document.createElement("canvas"),a.width=e.width,a.height=e.height,o=a.getContext("2d"),o.drawImage(e,0,0,a.width,a.height),i=null;try{i=a.toDataURL("image/png"),n=r(i)}catch(u){}return i?t._target.trigger("pasteImage",{blob:n,dataURL:i,width:e.width,height:e.height}):void 0}}(this),e.onerror=function(e){return function(){return e._target.trigger("pasteImageError",{message:"Failed to get image from: "+t,url:t})}}(this),e.src=t)},e.prototype._checkImagesInContainer=function(e){var n,r,a,o,i;for(i=Math.floor(1e3*Math.random()),o=this._container.find("img"),r=0,a=o.length;a>r;r++)n=o[r],n["_paste_marked_"+i]=!0;return setTimeout(function(r){return function(){var a,o,u;for(u=r._container.find("img"),a=0,o=u.length;o>a;a++)n=u[a],n["_paste_marked_"+i]||e(n.src),t(n).remove();return r._target.trigger("_pasteCheckContainerDone")}}(this),1)},e}()}).call(this);